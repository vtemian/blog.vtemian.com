<html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,minimum-scale=1"><meta content="python,mro,multiple inheritance,python multiple inheritance" name=keywords><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.1/styles/atom-one-light.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.1/highlight.min.js></script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.vtemian.com\/"},"articleSection":"post","name":"Python Multiple Inheritance","headline":"Python Multiple Inheritance","description":"How multiple inheritance works in Python?","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2020","datePublished":"2020-05-01 14:03:00 \u002b0200 \u002b0200","dateModified":"2020-05-01 14:03:00 \u002b0200 \u002b0200","url":"https:\/\/blog.vtemian.com\/post\/multiple-inheritance\/","wordCount":"892","keywords":["python","mro","multiple inheritance","python multiple inheritance","Blog"]}</script><title>Python Multiple Inheritance</title>
<link href="https://fonts.googleapis.com/css?family=Karla:700,Rubik:400,400i,Inconsolata:400" rel=stylesheet><link rel=stylesheet href=https://blog.vtemian.com/output/index.css media=screen><script type=text/javascript src=https://blog.vtemian.com/output/index.be2bf1e28ff3cbeea8f85056ff8994aa80e027b5c3ff3bcfbe0c4e525527151a.js integrity="sha256-vivx4o/zy+6o+FBW/4mUqoDgJ7XD/zvPvgxOUlUnFRo=" crossorigin=anonymous defer></script><meta name=google-site-verification content="2qk_e0y84NNSVpaorKgeNURYF9Ni3UyJvPq9GZdGEgs"></head><body><div class="container container--is-large"><main class=article><article><header><a href=https://blog.vtemian.com/>&larr; Go back</a><h1>Python Multiple Inheritance</h1><aside class="author author--is-small"><img src=https://blog.vtemian.com/output/avatar.png><div><h4>Vlad Temian</h4><p>01 May 2020</p></div></aside></header><p><p>Inheritance, a simple and evil mechanism for re-using code, can get tricky. Traditionally, you may have encountered inheritance when you wanted to extend or override a class&rsquo;s behavior.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pet</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>walk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;walk&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>eat</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;talk&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>talk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;!@#$&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Dog</span>(Pet):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>talk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Ham!&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cat</span>(Pet):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>talk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Miau!&#34;</span>)
</span></span></code></pre></div><p>Fairly easy to understand and follow. Dog and Cat share most of Pet&rsquo;s behavior, with some &ldquo;small&rdquo; particularities.
Let&rsquo;s say that we want to isolate particular behavior, for better testing purposes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Eats</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>eat</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;eat&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Walks</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>walk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;walk&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Talks</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>talk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;talk&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>Dog</span>(Eats, Walks, Talks):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>talk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Ham!&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cat</span>(Eats, Walks, Talks):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>talk</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Miau!&#34;</span>)
</span></span></code></pre></div><p>It may look a little bit weird, but isolating eating, walking and talking, improve re-usability, and may ease testing, but adds complexity and it increases readability efforts.</p><p>What&rsquo;s Dog&rsquo;s or Cat&rsquo;s behavior? Well, you need to look at its parents. They inherit from Eats, Walks, and Talks. That class is commonly known as Mixins. Using multiple inheritances, you can compose specific behaviors. Think about playing with Lego. Using well defined, independent components, you can build complex constructs. In practice, you may use mixins within models, forms, serializers, views, etc.</p><p>Multiple-inheritance seems to work for independent components that don&rsquo;t share state or behavior. What&rsquo;s going to happen when you try to combine a Dog and a Cat into a SuperPet?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SuperPet</span>(Cat, Dog):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>super_pet <span style=color:#f92672>=</span> SuperPet()
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> super_pet<span style=color:#f92672>.</span>talk() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Miau!&#34;</span>
</span></span></code></pre></div><p>SuperPet will inherit all the methods and properties of Dog and Cat and will respect the Method Resolution Order. More exactly, the C3 Method Resolution Order, which was initially released in a paper in 1996, designed for Dylan, called <a href=https://doi.org/10.1145/236337.236343>&ldquo;A Monotonic Superclass Linearization for Dylan&rdquo;</a>. It&rsquo;s implemented in other languages as well, Raku, Parrot, Solidarity, and Perl 5 (as a non-default option).</p><p>Ok, it starts to look complicated, but basically, it just takes the methods of the left-most class, right?
Almost.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GrandParent</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Grandparent&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Mother</span>(GrandParent):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Mother, son of&#34;</span>)
</span></span><span style=display:flex><span>        super()<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Father</span>(GrandParent):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Father, son of&#34;</span>)
</span></span><span style=display:flex><span>        super()<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Child</span>(Mother, Father):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;I&#39;m child, son of&#34;</span>)
</span></span><span style=display:flex><span>        super()<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>child <span style=color:#f92672>=</span> Child()
</span></span><span style=display:flex><span>child<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>I<span style=color:#e6db74>&#39;m child, son of</span>
</span></span><span style=display:flex><span>Mother, son of
</span></span><span style=display:flex><span>Father, son of
</span></span><span style=display:flex><span>Grandparent
</span></span></code></pre></div><p>Introducing super() and we&rsquo;ll discover pretty cool interactions.
Going a little deeper, Method Resolution Order (further referring to MRO) represents a set of rules that compute the linearization (a scary term that represents a serial way in which nested classes inherit from each other). Basically, it flattens the graph hierarchy. From:</p><p><img src=https://blog.vtemian.com/parents.jpg alt></p><p>to something more like <code>[Child, Mother, Father, GrandParent]</code>.</p><p>The problem above is also known as the <a href=https://en.wikipedia.org/wiki/Multiple_inheritance>Diamond problem</a>.
We can easily describe the linearization process as a recursive algorithm: Child + merge(linearization(Mother), linearization(Father)) or Child + the merge of linearization of the parents and the list of the parents. It seems a little trivial, but let&rsquo;s try a more <a href=https://www.python.org/download/releases/2.3/mro/>complex example</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>O</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>F</span>(O):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>E</span>(O):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>D</span>(O):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>C</span>(D, F):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>B</span>(D, E):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>A</span>(B, C):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span></code></pre></div><p><img src=https://blog.vtemian.com/complex.jpg alt></p><pre tabindex=0><code>MRO(O) = O
MRO(F) = F, O
MRO(E) = E, O
MRO(D) = D, O

MRO(C) = C + merge(MRO(D), MRO(F) + MRO(DF))
       = C + merge([D, O], [F, O], [D, F])
       = C + D + merge([O], [F, O], [F])
       = C + D + F + merge([O], [O])
       = C + D + F + O
       = C, D, F, O

MRO(B) = B + merge(MRO(D), MRO(E), MRO(DE))
       = B + merge([D, O], [E, O], [D, E])
       = B + D + merge([O], [E, O], [E])
       = B + D + E + merge([O], [O])
       = B + D + E + O

MRO(A) = A + merge([B, D, E, O], [C, D, F, O], [B, C])
       = A + B + merge([D, E, O], [C, D, F, O], [C])
       = A + B + C + merge([D, E, O], [D, F, O])
       = A + B + C + D + merge([E, O]), [F, O])
       = A + B + C + D + E + merge([O], [F, O])
       = A + B + C + D + E + F + merge([O], [O])
       = A + B + C + D + E + F + O
</code></pre><p>You can double check it, using the <code>mro</code> function:</p><pre tabindex=0><code>(&lt;class &#39;__main__.A&#39;&gt;, &lt;class &#39;__main__.B&#39;&gt;, &lt;class &#39;__main__.C&#39;&gt;, &lt;class &#39;__main__.D&#39;&gt;, &lt;class &#39;__main__.E&#39;&gt;, &lt;class
&#39;__main__.F&#39;&gt;, &lt;class &#39;__main__.O&#39;&gt;, &lt;class &#39;object&#39;&gt;)
</code></pre><p>And, of course, you can have your own MRO, no problem. All you need to do is to define a method called <code>mro</code> inside a metaclass.
Random MRO is not that smart, but for sure is interesting.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GrandParent</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Grandparent&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Mother</span>(GrandParent):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Mother, son of&#34;</span>)
</span></span><span style=display:flex><span>        super()<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Father</span>(GrandParent):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Father, son of&#34;</span>)
</span></span><span style=display:flex><span>        super()<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RandomMRO</span>(type):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>mro</span>(cls):
</span></span><span style=display:flex><span>        parents <span style=color:#f92672>=</span> [Father, Mother, GrandParent]
</span></span><span style=display:flex><span>        random<span style=color:#f92672>.</span>shuffle(parents)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> [cls] <span style=color:#f92672>+</span> parents <span style=color:#f92672>+</span> [object]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Child</span>(metaclass<span style=color:#f92672>=</span>RandomMRO):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>describe</span>(self):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;I&#39;m child, son of&#34;</span>)
</span></span><span style=display:flex><span>        super()<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>child <span style=color:#f92672>=</span> Child()
</span></span><span style=display:flex><span>child<span style=color:#f92672>.</span>describe()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> 
</span></span><span style=display:flex><span>[<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>class</span> <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#a6e22e>__main__</span><span style=color:#f92672>.</span>Mother<span style=color:#e6db74>&#39;&gt;, &lt;class &#39;</span>__main__<span style=color:#f92672>.</span>GrandParent<span style=color:#e6db74>&#39;&gt;, &lt;class &#39;</span>__main__<span style=color:#f92672>.</span>Father<span style=color:#e6db74>&#39;&gt;]</span>
</span></span><span style=display:flex><span>I<span style=color:#e6db74>&#39;m child, son of</span>
</span></span><span style=display:flex><span>Mother, son of
</span></span><span style=display:flex><span>Grandparent
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>class</span> <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#a6e22e>__main__</span><span style=color:#f92672>.</span>Father<span style=color:#e6db74>&#39;&gt;, &lt;class &#39;</span>__main__<span style=color:#f92672>.</span>GrandParent<span style=color:#e6db74>&#39;&gt;, &lt;class &#39;</span>__main__<span style=color:#f92672>.</span>Mother<span style=color:#e6db74>&#39;&gt;]</span>
</span></span><span style=display:flex><span>I<span style=color:#e6db74>&#39;m child, son of</span>
</span></span><span style=display:flex><span>Father, son of
</span></span><span style=display:flex><span>Grandparent
</span></span></code></pre></div><p>Multiple inheritance can get messy and for the full story please take a look at <a href=https://www.python.org/download/releases/2.3/mro/>https://www.python.org/download/releases/2.3/mro/</a>.
It can be really fun to play with, but in the long run it can be a real trouble maker.</p><p>Cheers 🍺!</p><p>Thanks <a href=https://twitter.com/catileptic>@catileptic</a> for the awesome illustrations!</p></p></article></main><script>hljs.initHighlightingOnLoad()</script><footer class=footer>&copy; 2024 <a href=https://github.com/vtemian>Vlad Temian</a>,
powered by <a href=https://gohugo.io/ target=_blank>Hugo</a>,
with help from <a href=https://github.com/balajmarius>&copy;balajmarius</a>.</footer></div></body></html>