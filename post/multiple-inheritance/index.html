<html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,minimum-scale=1"><meta content="python,mro,multiple inheritance,python multiple inheritance" name=keywords><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.1/styles/atom-one-light.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.1/highlight.min.js></script><meta itemprop=name content="Python Multiple Inheritance"><meta itemprop=description content="How multiple inheritance works in Python?"><meta itemprop=datePublished content=2020-05-01T14:03:00&#43;02:00><meta itemprop=dateModified content=2020-05-01T14:03:00&#43;02:00><meta itemprop=wordCount content=892><meta itemprop=keywords content="python,mro,multiple inheritance,python multiple inheritance,"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.vtemian.com/"},"articleSection":"post","name":"Python Multiple Inheritance","headline":"Python Multiple Inheritance","description":"How multiple inheritance works in Python?","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2020","datePublished":"2020-05-01 14:03:00 &#43;0200 &#43;0200","dateModified":"2020-05-01 14:03:00 &#43;0200 &#43;0200","url":"https://blog.vtemian.com/post/multiple-inheritance/","wordCount":"892","keywords":["python","mro","multiple inheritance","python multiple inheritance","Blog"]}</script><title>Python Multiple Inheritance</title><link href="https://fonts.googleapis.com/css?family=Karla:700,Rubik:400,400i" rel=stylesheet><link rel=stylesheet href=https://blog.vtemian.com/output/index.b46971849f7d4bff2fff7ea5434b8ee9633cbb4d5bbba1d46622879079ce9b42.css integrity="sha256-tGlxhJ99S/8v/36lQ0uO6WM8u01bu6HUZiKHkHnOm0I=" crossorigin=anonymous><script type=text/javascript src=https://blog.vtemian.com/output/index.aad5319fa68d4ffea7c51f2994cd36ba8a8fb9a460f3a9f54e49efa059e47d3b.js integrity="sha256-qtUxn6aNT/6nxR8plM02uoqPuaRg86n1TknvoFnkfTs=" crossorigin=anonymous defer></script><meta name=google-site-verification content=2qk_e0y84NNSVpaorKgeNURYF9Ni3UyJvPq9GZdGEgs></head><body><div class="container container--is-large"><main class=article><article><header><a href=https://blog.vtemian.com/>&larr; Go back</a><h1>Python Multiple Inheritance</h1><aside class="author author--is-small"><img src=https://blog.vtemian.com/output/avatar@2x.9d6360be.jpg><div><h4>Vlad Temian</h4><p>01 May 2020</p></div></aside></header><p><p>Inheritance, a simple and evil mechanism for re-using code, can get tricky. Traditionally, you may have encountered inheritance when you wanted to extend or override a class&rsquo;s behavior.</p><pre><code class=language-python>class Pet:
    def walk(self):
        print(&quot;walk&quot;)

    def eat(self):
        print(&quot;talk&quot;)

    def talk(self):
        print(&quot;!@#$&quot;)

class Dog(Pet):
    def talk(self):
        print(&quot;Ham!&quot;)

class Cat(Pet):
    def talk(self):
        print(&quot;Miau!&quot;)
</code></pre><p>Fairly easy to understand and follow. Dog and Cat share most of Pet&rsquo;s behavior, with some &ldquo;small&rdquo; particularities.
Let&rsquo;s say that we want to isolate particular behavior, for better testing purposes.</p><pre><code class=language-python>class Eats:
    def eat(self):
        print(&quot;eat&quot;)

class Walks:
    def walk(self):
        print(&quot;walk&quot;)

class Talks:
    def talk(self):
        print(&quot;talk&quot;)

def Dog(Eats, Walks, Talks):
    def talk(self):
        print(&quot;Ham!&quot;)

class Cat(Eats, Walks, Talks):
    def talk(self):
        print(&quot;Miau!&quot;)
</code></pre><p>It may look a little bit weird, but isolating eating, walking and talking, improve re-usability, and may ease testing, but adds complexity and it increases readability efforts.</p><p>What&rsquo;s Dog&rsquo;s or Cat&rsquo;s behavior? Well, you need to look at its parents. They inherit from Eats, Walks, and Talks. That class is commonly known as Mixins. Using multiple inheritances, you can compose specific behaviors. Think about playing with Lego. Using well defined, independent components, you can build complex constructs. In practice, you may use mixins within models, forms, serializers, views, etc.</p><p>Multiple-inheritance seems to work for independent components that don&rsquo;t share state or behavior. What&rsquo;s going to happen when you try to combine a Dog and a Cat into a SuperPet?</p><pre><code class=language-python>class SuperPet(Cat, Dog):
    pass


super_pet = SuperPet()
assert super_pet.talk() == &quot;Miau!&quot;
</code></pre><p>SuperPet will inherit all the methods and properties of Dog and Cat and will respect the Method Resolution Order. More exactly, the C3 Method Resolution Order, which was initially released in a paper in 1996, designed for Dylan, called <a href=https://doi.org/10.1145/236337.236343>&ldquo;A Monotonic Superclass Linearization for Dylan&rdquo;</a>. It&rsquo;s implemented in other languages as well, Raku, Parrot, Solidarity, and Perl 5 (as a non-default option).</p><p>Ok, it starts to look complicated, but basically, it just takes the methods of the left-most class, right?
Almost.</p><pre><code class=language-python>class GrandParent:
    def describe(self):
        print(&quot;Grandparent&quot;)

class Mother(GrandParent):
    def describe(self):
        print(&quot;Mother, son of&quot;)
        super().describe()

class Father(GrandParent):
    def describe(self):
        print(&quot;Father, son of&quot;)
        super().describe()

class Child(Mother, Father):
    def describe(self):
        print(&quot;I'm child, son of&quot;)
        super().describe()

child = Child()
child.describe()

&gt;&gt;&gt;&gt;

I'm child, son of
Mother, son of
Father, son of
Grandparent
</code></pre><p>Introducing super() and we&rsquo;ll discover pretty cool interactions.
Going a little deeper, Method Resolution Order (further referring to MRO) represents a set of rules that compute the linearization (a scary term that represents a serial way in which nested classes inherit from each other). Basically, it flattens the graph hierarchy. From:</p><p><img src=https://blog.vtemian.com/parents.jpg alt></p><p>to something more like <code>[Child, Mother, Father, GrandParent]</code>.</p><p>The problem above is also known as the <a href=https://en.wikipedia.org/wiki/Multiple_inheritance>Diamond problem</a>.
We can easily describe the linearization process as a recursive algorithm: Child + merge(linearization(Mother), linearization(Father)) or Child + the merge of linearization of the parents and the list of the parents. It seems a little trivial, but let&rsquo;s try a more <a href=https://www.python.org/download/releases/2.3/mro/>complex example</a>:</p><pre><code class=language-python>class O:
    pass

class F(O):
    pass

class E(O):
    pass

class D(O):
    pass

class C(D, F):
    pass

class B(D, E):
    pass

class A(B, C):
    pass
</code></pre><p><img src=https://blog.vtemian.com/complex.jpg alt></p><pre><code>MRO(O) = O
MRO(F) = F, O
MRO(E) = E, O
MRO(D) = D, O

MRO(C) = C + merge(MRO(D), MRO(F) + MRO(DF))
       = C + merge([D, O], [F, O], [D, F])
       = C + D + merge([O], [F, O], [F])
       = C + D + F + merge([O], [O])
       = C + D + F + O
       = C, D, F, O

MRO(B) = B + merge(MRO(D), MRO(E), MRO(DE))
       = B + merge([D, O], [E, O], [D, E])
       = B + D + merge([O], [E, O], [E])
       = B + D + E + merge([O], [O])
       = B + D + E + O

MRO(A) = A + merge([B, D, E, O], [C, D, F, O], [B, C])
       = A + B + merge([D, E, O], [C, D, F, O], [C])
       = A + B + C + merge([D, E, O], [D, F, O])
       = A + B + C + D + merge([E, O]), [F, O])
       = A + B + C + D + E + merge([O], [F, O])
       = A + B + C + D + E + F + merge([O], [O])
       = A + B + C + D + E + F + O
</code></pre><p>You can double check it, using the <code>mro</code> function:</p><pre><code>(&lt;class '__main__.A'&gt;, &lt;class '__main__.B'&gt;, &lt;class '__main__.C'&gt;, &lt;class '__main__.D'&gt;, &lt;class '__main__.E'&gt;, &lt;class
'__main__.F'&gt;, &lt;class '__main__.O'&gt;, &lt;class 'object'&gt;)
</code></pre><p>And, of course, you can have your own MRO, no problem. All you need to do is to define a method called <code>mro</code> inside a metaclass.
Random MRO is not that smart, but for sure is interesting.</p><pre><code class=language-python>import random


class GrandParent:
    def describe(self):
        print(&quot;Grandparent&quot;)


class Mother(GrandParent):
    def describe(self):
        print(&quot;Mother, son of&quot;)
        super().describe()


class Father(GrandParent):
    def describe(self):
        print(&quot;Father, son of&quot;)
        super().describe()


class RandomMRO(type):
    def mro(cls):
        parents = [Father, Mother, GrandParent]
        random.shuffle(parents)
        return [cls] + parents + [object]


class Child(metaclass=RandomMRO):
    def describe(self):
        print(&quot;I'm child, son of&quot;)
        super().describe()


child = Child()
child.describe()

&gt;&gt;&gt; 
[&lt;class '__main__.Mother'&gt;, &lt;class '__main__.GrandParent'&gt;, &lt;class '__main__.Father'&gt;]
I'm child, son of
Mother, son of
Grandparent
&gt;&gt;&gt;
[&lt;class '__main__.Father'&gt;, &lt;class '__main__.GrandParent'&gt;, &lt;class '__main__.Mother'&gt;]
I'm child, son of
Father, son of
Grandparent
</code></pre><p>Multiple inheritance can get messy and for the full story please take a look at <a href=https://www.python.org/download/releases/2.3/mro/>https://www.python.org/download/releases/2.3/mro/</a>.
It can be really fun to play with, but in the long run it can be a real trouble maker.</p><p>Cheers üç∫!</p><p>Thanks <a href=https://twitter.com/catileptic>@catileptic</a> for the awesome illustrations!</p></p></article></main><script>hljs.initHighlightingOnLoad();</script><footer class=footer>&copy; 2020 <a href=https://github.com/vtemian>Vlad Temian</a>,
powered by <a href=https://gohugo.io/ target=_blank>Hugo</a>,
with help from <a href=https://github.com/balajmarius>&copy;balajmarius</a>.</footer></div></body></html>